<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Avis Vinted</title>
    <link rel="stylesheet" href="assets/css/components/reviews.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .ticker-review-item {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .ticker-review-text {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
        }
        .ticker-review-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #666;
        }
        .debug-info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üß™ Test des Avis Vinted R√©els</h1>
    
    <div class="test-section">
        <h2>üìä Informations Debug</h2>
        <div id="debug-info" class="debug-info">
            Chargement des donn√©es...
        </div>
    </div>
    
    <div class="test-section">
        <h2>üé¢ Preview du Ticker (premi√®re fois)</h2>
        <div class="reviews-ticker">
            <div class="reviews-ticker-header">
                <h3>Avis des Clients Vinted</h3>
                <span class="live-indicator">
                    <span class="live-dot"></span>
                    LIVE
                </span>
            </div>
            <div class="reviews-ticker-container">
                <div id="reviews-ticker-content-test">
                    <!-- Contenu g√©n√©r√© par JS -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>üìù Avis Individuels</h2>
        <div id="individual-reviews">
            <!-- Contenu g√©n√©r√© par JS -->
        </div>
    </div>

    <script>
        // Test direct des donn√©es
        async function testReviewsData() {
            const debugDiv = document.getElementById('debug-info');
            const tickerContainer = document.getElementById('reviews-ticker-content-test');
            const individualContainer = document.getElementById('individual-reviews');
            
            try {
                // Charger les donn√©es
                const response = await fetch('data/reviews.json');
                if (!response.ok) throw new Error('Erreur HTTP: ' + response.status);
                
                const data = await response.json();
                const reviews = data.reviews || [];
                
                // Debug info
                debugDiv.innerHTML = `
                    <strong>‚úÖ Donn√©es charg√©es avec succ√®s !</strong><br>
                    üìä Nombre d'avis: ${reviews.length}<br>
                    üïê Derni√®re mise √† jour: ${data.last_updated}<br>
                    üîó Source: ${data.source}<br><br>
                    <strong>Structure d'un avis:</strong><br>
                    ${JSON.stringify(reviews[0] || {}, null, 2)}
                `;
                
                if (reviews.length === 0) {
                    tickerContainer.innerHTML = '<p style="color: red;">‚ùå Aucun avis trouv√©</p>';
                    return;
                }
                
                // G√©n√©rer le contenu du ticker
                const tickerHTML = reviews.map((review, index) => `
                    <div class="ticker-review-item" data-index="${index}">
                        <div class="ticker-review-text">
                            "${review.comment || review.text || 'Pas de commentaire'}"
                        </div>
                        <div class="ticker-review-meta">
                            <span class="ticker-review-author">
                                üë§ ${review.username || review.author || 'Client'}
                            </span>
                            <span>‚≠ê ${review.rating}/5 - ${review.date || 'Date inconnue'}</span>
                        </div>
                    </div>
                `).join('');
                
                tickerContainer.innerHTML = tickerHTML;
                
                // Avis individuels
                const individualHTML = reviews.map((review, index) => `
                    <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px;">
                        <h4>Avis #${index + 1}: ${review.username || review.author || 'Utilisateur'}</h4>
                        <div style="color: #666; margin-bottom: 10px;">
                            ${review.date || 'Date inconnue'} | Note: ${review.rating}/5 ‚≠ê
                        </div>
                        <div style="font-style: italic; color: #333;">
                            "${review.comment || review.text || 'Pas de commentaire'}"
                        </div>
                        <small style="color: #999;">Source: ${review.source || 'inconnue'}</small>
                    </div>
                `).join('');
                
                individualContainer.innerHTML = individualHTML;
                
            } catch (error) {
                debugDiv.innerHTML = `
                    <strong style="color: red;">‚ùå Erreur de chargement:</strong><br>
                    ${error.message}<br><br>
                    <strong>V√©rifications √† faire:</strong><br>
                    1. Le fichier data/reviews.json existe-t-il ?<br>
                    2. Le serveur HTTP est-il d√©marr√© ?<br>
                    3. Y a-t-il des erreurs dans la console ?
                `;
                console.error('Erreur test:', error);
            }
        }
        
        // D√©marrer le test
        document.addEventListener('DOMContentLoaded', testReviewsData);
    </script>
</body>
</html>